### **Web 班风评比系统 - 开发说明书 (完整版)**

---

### 1. 项目概述

**1.1. 项目名称**
Web 班风评比系统

**1.2. 项目目标**
本项目旨在开发一个集**学生、班级、宿舍**三大核心模块于一体的综合性评价管理平台。系统将围绕以下几个方面，实现对校园风气的精细化、数据化管理：
*   **学生评价**：提供针对学生的指标管理、过程点评、小组互评、数据统计与报表，并为每位学生生成个人成长档案。
*   **班级评价**：支持对班级集体进行指标设置、过程点评，并生成班级维度的评价记录与报表。
*   **宿舍评价**：将评价体系延伸至生活区，涵盖宿舍设置、卫生安全检查、过程打分与数据统计。

通过以上功能，系统旨在取代传统纸质评比，激励学生积极行为，辅助教师高效管理，并为学校德育工作提供科学决策支持。

**1.3. 核心用户与角色**
*   **系统管理员 (Admin):** 负责系统的基础配置和维护，如用户、组织架构、权限、评价体系等。
*   **教师/班主任 (Teacher):** 系统的核心使用者，负责执行日常评价、查看统计报表、发布公告等。
*   **学生 (Student):** 系统的主要参与者，可以查看个人评价记录、成长档案，并可能参与小组互评。

---

### 2. 功能模块详述


**学生评价模块**

1.  `StudentIndicatorManagement.tsx`: **学生评价指标管理** 
    *   **功能**：一个表格页面，用于增、删、改、查针对学生的评价指标（如“课堂发言”、“作业上交”）。

2.  `StudentProcessGrading.tsx`: **学生过程点评** 
    *   **功能**：核心操作页面。教师选择班级后，会看到学生列表。点击学生可以进行实时打分和评语录入。

3.  `StudentEvaluationRecords.tsx`: **学生评价记录** 
    *   **功能**：用于查询和展示学生评价记录的页面。教师可以选择学生和日期，查看其在各项指标上的得分详情。

4.  `StudentEvaluationReports.tsx`: **学生评价报表** 
    *   **功能**：用于生成和查看学生的日报、周报、月报。提供日期筛选和导出功能。

5.  `StudentGrowthFile.tsx`: **学生个人成长档案**
    *   **功能**：一个详细的学生个人主页，汇集该学生所有的评价历史、得分趋势图和教师评语。

6.  `StudentGroupEvaluation.tsx`: **学生小组评价**
    *   **功能**：教师可以对学生分成不同的小组，对小组进行打分，即对组内每个人进行打分。

**班级评价模块**

7.  `ClassIndicatorManagement.tsx`: **班级评价指标管理** 
    *   **功能**：与学生指标管理类似，但针对的是班级集体指标（如“上课睡觉，扣2分”、“乱扔垃圾扣1分”）。

8.  `ClassProcessGrading.tsx`: **班级过程点评** 
    *   **功能**：供年级组长或值班领导使用的页面，对整个班级的集体表现进行打分。

9.  `ClassEvaluationRecords.tsx`: **班级评价记录** 
    *   **功能**：用于查询和展示班级评价记录的页面。教师可以选择班级和日期，查看其在各项指标上的得分详情等。

10. `ClassEvaluationReports.tsx`: **班级评价报表** 
    *   **功能**：用于生成和查看班级的日报、周报、月报。提供日期筛选和导出功能。

**宿舍评价模块**

11. `DormitorySettings.tsx`: **宿舍设置**
    *   **功能**：管理宿舍楼、房间，并将学生分配到具体床位。通常使用树形控件或可编辑表格实现。

12. `DormitoryIndicatorManagement.tsx`: **宿舍评价指标管理**
    *   **功能**：增、删、改、查宿舍的评价指标（如“内务整洁”、“晚归”）。

13. `DormitoryProcessGrading.tsx`: **宿舍过程评价**
    *   **功能**：供宿管人员使用的页面（重点优化移动端体验），用于对宿舍进行检查和打分。

14. `DormitoryEvaluationRecords.tsx`: **宿舍评价记录**
    *   **功能**：数据可视化仪表盘，展示宿舍得分排名、优秀宿舍和待改进宿舍列表。

**校务管理模块**

15. `AnnouncementList.tsx`: **教师公告管理**
    *   **功能**：教师可以在此创建、编辑、发布和删除公告。

16. `AnnouncementView.tsx`: **公告查看**
    *   **功能**：一个信息流页面，供所有用户查看已发布的公告。

**系统管理页面**

这些页面通常只有管理员可以访问。

17. `User/Login.tsx`: **登录页**
    *   **功能**：系统入口。

18. `Admin/TeacherManagement.tsx`: **教师管理**
    *   **功能**：管理教师账户信息，支持批量导入。

19. `Admin/StudentManagement.tsx`: **学生管理**
    *   **功能**：管理学生账户和基本信息，支持批量导入和分配班级。

20. `Admin/RoleManagement.tsx`: **权限管理**
    *   **功能**：创建角色（如“班主任”、“科任老师”、“宿管”），并为角色分配可访问的页面和操作权限。

21. `Admin/Settings/TermSettings.tsx`: **学期设置**
    *   **功能**：配置学年和学期信息。

22. `Admin/Settings/OrgSettings.tsx`: **组织架构设置**
    *   **功能**：一个统一管理 `年级设置` 和 `班别设置` 的页面。

23. `Admin/Settings/SystemConfig.tsx`: **系统设置**
    *   **功能**：配置系统名称、Logo、以及其他全局参数。

24. `Admin/Settings/WeChatConfig.tsx`: **微信配置**
    *   **功能**：填写微信公众号或小程序的 AppID 和 Secret，用于消息推送。

25. `Admin/Backup/DatabaseBackup.tsx`: **数据库备份**
    *   **功能**：提供手动备份和查看自动备份历史的界面。


---

### 3. 非功能性需求

*   **3.1. 性能:** 系统应保证高并发下的快速响应，特别是教师进行高频次点评操作时。报表生成和数据查询应在数秒内完成。
*   **3.2. 易用性:** 界面设计应简洁直观，特别是移动端，要方便教师在巡查时单手操作。
*   **3.3. 安全性:** 严格的权限控制，确保数据隔离，普通教师只能看到自己班级的数据。学生隐私信息需要脱敏处理。
*   **3.4. 扩展性:** 系统架构应易于扩展，未来可方便地增加如在线请假、活动报名、家校互动等新模块。

---

### 4. 技术选型建议

*   **前端:**
    *   **PC 端:** **React + Ant Design Pro**。
    *   **移动端:** **Ant Design Mobile** 或响应式设计。

*   **后端:**
    *   **框架:** **Node.js + NestJS**。
    *   **数据库:** **MySQL 8** 或 **PostgreSQL 14**。
    *   **缓存:** **Redis**。

---

### 5. 开发实施建议 (MVP - 最小可行产品)

根据更新后的页面清单，建议将开发过程分为以下四个阶段：

*   **第一阶段：核心框架与基础评价功能 (约 2-3 周)**
    1.  **搭建核心系统**: 完成 **系统管理页面** 中的基础功能，包括 `登录`、`教师/学生管理`、`权限管理` 和 `组织架构设置`。这是保障系统能正常运行的前提。
    2.  **实现核心评价流程**: 开发 **学生评价** 和 **班级评价** 模块的 `指标管理` 和 `过程点评` 功能。
    3.  **[前端先行]**: 在此阶段，前端可利用 Mock API 独立开发，无需等待后端接口。
    4.  **阶段目标**: 教师可以登录系统，完成基础的用户和组织管理，并对学生和班级进行日常的评价打分。

*   **第二阶段：数据可视化与报表 (约 2 周)**
    1.  **开发数据看板**: 完成 **学生评价** 和 **班级评价** 模块的 `评价记录` 页面，实现数据的图表化展示。
    2.  **开发报表功能**: 完成 `学生评价报表` 和 `班级评价报表` 的开发，支持数据的筛选和导出。
    3.  **上线校务管理**: 开发 `教师公告管理` 和 `公告查看` 功能。
    4.  **阶段目标**: 实现评价数据的可视化分析，让管理人员可以直观地查看评价结果，并上线基础的校务沟通功能。

*   **第三阶段：功能拓展与场景延伸 (约 2 周)**
    1.  **上线宿舍评价**: 完成 **宿舍评价模块** 的全部功能，包括 `宿舍设置`、`指标管理`、`过程评价` 和 `评价记录`。
    2.  **深化学生评价**: 开发 `学生个人成长档案` 和 `学生小组评价` 功能，丰富学生评价维度。
    3.  **阶段目标**: 将评价场景从教室扩展到宿舍，并为学生提供更全面的成长记录和互动评价方式。

*   **第四阶段：系统完善与维护 (约 1 周)**
    1.  **完成剩余管理功能**: 开发 `系统设置`、`微信配置`、`数据库备份` 等高级系统管理功能。
    2.  **全面测试与优化**: 进行系统性的功能测试、性能压力测试和用户体验优化。
    3.  **阶段目标**: 确保系统稳定、安全、易用，完成所有功能的开发和交付。

---


### 6. 当前进度记录（截至 2025-10-24）

- 导航与国际化
  - 左侧菜单已中文化，`config/routes.ts` 的 `name` 与 `src/locales/zh-CN/menu.ts` 完成一一对应。
- 报错排查
  - `index.global.js` 读取设置失败问题确认来源于浏览器扩展（非项目代码），建议使用隐身窗口/禁用扩展开发。
- UI/交互
  - “导入 CSV”由 `Upload.Dragger` 改为 `Upload + Button` 紧凑样式，涉及文件：
    - `src/pages/Admin/TeacherManagement.tsx`
    - `src/pages/Admin/StudentManagement.tsx`
    - `src/pages/student/StudentIndicatorManagement.tsx`
- 性能与内存
  - 提供并执行目录清理建议（`.umi/`, `dist/`, `node_modules/.cache`）。
  - 建议编辑器仅索引项目必要目录、禁用高开销插件。
  - 进程/端口排查已完成：本地开发 `umi dev` 监听 `8000`。
- 学生模块
  - 已完成：`StudentEvaluationReports.tsx`（统计卡、筛选、导出）。
  - 过程点评：`StudentProcessGrading.tsx` 已实现按“指标 × 方向（加/减）× 次数”计算最终分数并落库。
- 班级模块
  - 新增四页并接通 Mock/Service：
    - `ClassIndicatorManagement.tsx`（CRUD、导入/导出）
    - `ClassProcessGrading.tsx`（按指标加/减分、支持负分指标）
    - `ClassEvaluationRecords.tsx`（查询、ProTable、导出）
    - `ClassEvaluationReports.tsx`（统计、导出）
- Mock 与服务层
  - Mock：`mock/user.ts` 中新增 `classIndicators`、`classEvaluations` 相关 REST 接口（GET/POST/PUT/DELETE、导入）。
  - Services：`src/services/student.ts` 新增/完善：
    - `createEvaluation`, `queryClassEvaluations`, `createClassEvaluation`,
      `queryClassIndicators`, `createClassIndicator`, `updateClassIndicator`,
      `deleteClassIndicator`, `importClassIndicators`。
- 路由与菜单
  - `config/routes.ts` 新增：学生 `reports`；新增 `class` 分组及其四个子路由。
  - 删除 `admin` 下二级管理页 `sub-page`。
- CSV 能力
  - `utils/csv` 支持通用导出；多页面接入导出当前筛选的数据；班级/学生指标支持导入。

下一步建议（MVP 后续）
- 完成学生评价记录页与个人成长档案（趋势图/画像）。
- 宿舍模块四页（设置、指标、过程、记录）。
- 公告管理与查看；权限粒度完善。
- 后端对接与数据持久化（数据库/鉴权/多角色）。

